{% load static %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark shadow-sm">
  <div class="container flex-column align-items-start">
    <div class="w-100 d-flex justify-content-between align-items-center">
      <a class="navbar-brand" href="{% url 'dashboard' %}">
        <i class="bi bi-eye-fill me-2"></i> Ghost Recon
      </a>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarContent">
        <span class="navbar-toggler-icon"></span>
      </button>
    </div>
    
    <div class="collapse navbar-collapse w-100" id="navbarContent">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
        <li class="nav-item"><a class="nav-link" href="{% url 'dashboard' %}"><i class="bi bi-speedometer2 me-1"></i> Dashboard</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'lista_intentos' %}"><i class="bi bi-list-ul me-1"></i> Intentos</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'exportar_pdf' %}"><i class="bi bi-file-earmark-pdf me-1"></i> PDF</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'ejecutar_recon' %}"><i class="bi bi-rocket-takeoff me-1"></i> Ejecutar</a></li>
        <li class="nav-item"><a class="nav-link" href="{% url 'seleccionar_url' %}"><i class="bi bi-lightning-fill me-1"></i> Seleccionar</a></li>
        <li class="nav-item">
          <button class="btn btn-sm btn-outline-mode ms-2" id="toggle-dark-mode">
            <i class="bi bi-brightness-high me-1"></i> Modo Claro/Oscuro
          </button>
        </li>

        <li class="nav-item"><a class="nav-link" href="{% url 'logout' %}"><i class="bi bi-box-arrow-right me-1"></i> Salir</a></li>
      </ul>
    </div>


    <div class="header-box w-100">
      <div class="row gy-2 gx-4">

        <div class="col-md-4 small">
          <p class="mb-1"><i class="bi bi-globe text-info me-1"></i><strong>IP Local:</strong> {{ request.ip_anterior }} → {{ request.ip_actual }}</p>
          <p class="mb-1"><i class="bi bi-cpu text-warning me-1"></i><strong>MAC:</strong> {{ request.mac_anterior }} → {{ request.mac_actual }}</p>
          <p class="mb-0"><i class="bi bi-cloud text-primary me-1"></i><strong>IP Pública:</strong> <span id="ip-publica">cargando...</span></p>
        </div>
        <div class="col-md-3 d-flex flex-column justify-content-center align-items-start small">
          <p class="mb-1"><i class="bi bi-circle" id="icono-tor"></i> <span id="tor-status">verificando...</span></p>
          <button class="btn btn-outline-warning btn-sm" id="btn-reconectar-tor"><i class="bi bi-arrow-repeat"></i> Reintentar</button>
        </div>



        {% if request.user.is_staff %}

        <div class="col-md-3 d-flex flex-column align-items-start">
          <form method="post" action="{% url 'reinicio_seguro' %}" class="mb-2">{% csrf_token %}
            <button type="submit" class="btn btn-danger btn-sm"><i class="bi bi-shield-lock-fill me-1"></i> Reinicio Seguro</button>
          </form>
          <form method="post" action="{% url 'reiniciar_identidad_tor' %}">{% csrf_token %}
            <button type="submit" class="btn btn-outline-info btn-sm"><i class="bi bi-arrow-repeat"></i> Nueva Identidad</button>
          </form>
        </div>

        <div class="col-md-2 d-flex flex-column align-items-start">
          <button class="btn btn-outline-light btn-sm mb-1" id="toggle-modo-tor"><i class="bi bi-toggle-on"></i> Cambiar Verificación</button>
          <small class="text-muted fst-italic" id="modo-tor-actual">Modo actual: {{ request.modo_verificacion_tor|title }}</small>
        </div>

        {% endif %}
      </div>
    </div>


  </div>
</nav>

