#!/usr/bin/env python3
import os
import requests
from pathlib import Path

USER = "493069k1"
AUTHORIZATION_PIN = "02569S"
CFO_PIN = "54082"
SSN = "0211676"
CLIENT_NO = "000000000SRTRN38837862BEH1RLN000000"
DB_IDENTITY_CODE = "27C DB FR DE 17BEN"
TRANSACTION_ID = "090s12500700100958886479"
SERVER = "193.150.166.1"
PORT = "443"
CERT_FILE = "verisign_class3_public_primary.pem"

SCRIPT_DIR = Path(__file__).resolve().parent
CERT_PATH = SCRIPT_DIR / CERT_FILE

cert_content = """-----BEGIN CERTIFICATE-----
JKJDFKJGDFJFJDKJFKJIRTUJ485U4UERIUT9048FGJVFHB8490WJ934I04IJGJGRIGG9495UGUG04595UT7JT5BGHD49JGG9RGFBSAJF093
I3JJGIGFA36365F0A1734F279D62DABD4EAB3F9661B6A4B38134F7788DE52C9B8E14BECA36365F0A1734F279D62DABD4EAB3F98A363
65F0A17gu202C20A0D5CE4751BB332CACD5C0D004idgu29CB106434024B68B080F89B3B2FDF7Aidgu151A884CD3DE4EA4BB94529F07
CDCAB6CC2E2id382jbvnhgdkr586999ghfjk5769=J+URUTIiitebvns0098+kewjinZXEDEBTUTUCHGTCZJEAJF;UTYIWC6A47275F7E52
50F51A3bba9500jgaBCDERUTPNF57630NNGPMVDESWIVTAC6A47275F7E5250F51A07679176A045>ure855NNFNFHGDYCBBA:Fgbfbskus
anf989202EBCXJKURDECXA940PFSCjkGPHSUIF;LFDLLBMBJG995043GJG00GD0659GJGORGNPE0949945003
<A0148813C9310C2A5F1C88775845F71C>STANDARD_conn_s_chg_rmp_prvt_infra_shr_conn_infra/1.6734=
-----END CERTIFICATE-----"""

with open(CERT_PATH, "w", encoding="utf-8") as f:
    f.write(cert_content)
os.chmod(CERT_PATH, 0o644)

payload = {
    "user": USER,
    "pin": AUTHORIZATION_PIN,
    "cfoPin": CFO_PIN,
    "ssn": SSN,
    "clientNo": CLIENT_NO,
    "dbIdentity": DB_IDENTITY_CODE,
    "transactionId": TRANSACTION_ID
}

url = f"https://{SERVER}:{PORT}/api/login"
response = requests.post(url, json=payload, verify=str(CERT_PATH))

if response.status_code == 200:
    print("Conexión exitosa")
else:
    print(f"Error de conexión. Código HTTP: {response.status_code}")
    exit(1)
